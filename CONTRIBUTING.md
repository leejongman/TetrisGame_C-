# Contributing

이 저장소에 기여하려는 개발자를 위한 가이드입니다. 특히 `tetris.c`의 Tetromino 표현 방식과 관련된 코딩 표준을 명확히 정의합니다.

## 기본 원칙

- 변경 전 항상 빌드하고 수동/자동 테스트를 실행합니다.
- 모든 변경은 코드 스타일 및 포맷 규칙(`.editorconfig`)을 준수해야 합니다.
- 커밋 메시지는 명확하고 간결하게 작성하세요. (예: `fix: handle spawn collision for I piece`)

## 코딩 스타일

- 인덴트: 스페이스 4칸
- 파일 내 변수/함수 이름은 소문자와 언더스코어(`snake_case`)를 사용합니다.
- 전역 상수는 대문자와 밑줄(`WIDTH`, `HEIGHT`)을 사용합니다.
- 새 기능 추가 시 기존 스타일을 따르며, 가능한 한 기존 구조체와 함수를 재사용하세요.

> 참고: 프로젝트 루트에 `.editorconfig` 파일이 존재하지 않으면 자동 생성됩니다. 모든 PR은 이 파일 규칙을 준수해야 합니다.

## Tetromino 표현 규칙 (중요)

`tetris.c`의 `Tetromino` 정의 및 `pieces` 배열은 다음 규칙을 따릅니다:

- `typedef struct { int x, y; } Point;`
  - `x`는 열(가로), `y`는 행(세로)을 의미합니다.
  - 좌표는 상대적 블록 좌표로, 보드의 좌상단을 (0,0)로 하는 절대 좌표가 아닙니다.

- `typedef struct { Point blocks[4][4]; int color; } Tetromino;`
  - `blocks[rotation][i]`는 특정 회전 상태에서의 4개 블록 좌표를 정의합니다.
  - `rotation` 인덱스는 0에서 3까지이며, 시계 방향 회전 단계를 의미합니다.
  - 각 회전의 좌표는 4x4 공간 내에서 정의되며, 회전 중심(offset)은 명시적으로 사용하지 않습니다. 기존 좌표셋과 충돌하지 않도록 새로운 블록 형상을 추가하세요.

- `pieces` 배열 순서 및 색상 매핑(현재 구현)
  - 인덱스 순서: 0=I, 1=O, 2=T, 3=S, 4=Z, 5=J, 6=L
  - `color` 값: I=1, O=2, T=3, S=4, Z=5, J=6, L=7
  - `color`는 비주얼 출력을 위한 정수 식별자이며, 콘솔 색상 매핑은 `draw()`에서 처리됩니다.

- 회전 규칙
  - 배열에 제공된 4개 회전형은 시계 방향으로 순차적으로 나열됩니다. 90° 회전은 `(cur_rot + 1) % 4`로 처리됩니다.
  - 회전 충돌 처리(벽킥 등)는 현재 단순 검사(`fits_piece`)만 사용합니다. 벽킥 시스템을 도입하려면 `fits_piece` 호출 전후로 좌표 보정을 추가해야 합니다.

## tetris.c 수정 시 체크리스트

- `pieces` 배열을 수정하는 경우:
  - 각 테트로미노에 대해 4개의 회전 상태가 포함되어야 합니다(정적 복제 가능형은 동일한 4개 상태를 반복).
  - 각 상태는 정확히 4개의 `Point` 항목을 가져야 합니다.
  - 새 블록 좌표가 보드 경계 및 기존 충돌 검사 로직과 호환되는지 확인합니다.
- `fits_piece`, `lock_piece`, `clear_lines` 로직을 수정하면 기존 보드 동작에 미치는 영향을 수동으로 검증하세요.

## 테스트

- 수동 플레이로 기본 동작(스폰, 회전, 착지, 라인 삭제, 홀드, 넥스트)을 확인하세요.
- 가능하면 자동화된 단위 테스트(좌표 변환, 라인 클리어 카운트 등)를 추가하세요.

## 기타

- 이 문서는 추후 프로젝트 규칙이 확장되면 갱신됩니다. PR로 개선 제안 환영합니다.